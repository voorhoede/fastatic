#!/usr/bin/env node

const fastatic = require('../index');
const Logger = require('../lib/logger');
const pkg = require('../package');
const reporter = require('../lib/reporter');

const program = require('commander')
	.version(pkg.version)
	.description(`${pkg.name} (v${pkg.version}): ${pkg.description}`)
	.usage('<src> [options]')
	.option('-d, --dest [value]', 'Output destination')
	.option('-l, --log-level [value]', 'Log level (silent|error|warn|verbose)', 'verbose')
	.parse(process.argv);

const logger = new Logger(program.logLevel);

fastatic({
		src: program.args[0],
		dest: program.dest,
		logLevel: program.logLevel
	})
	.then(output => reporter(output))
	.catch(err => {
		console.error(err.message);
		process.exitCode = 1;
	});
